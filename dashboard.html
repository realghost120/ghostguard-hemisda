<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>GhostGuard Panel</title>

<style>
:root{
  --bg:#060c18;
  --card:#101a2e;
  --blue:#3b82f6;
  --blueGlow:rgba(59,130,246,.4);
  --red:#ef4444;
  --yellow:#f59e0b;
  --green:#22c55e;
  --border:rgba(255,255,255,.08);
  --text:#e6f0ff;
  --muted:rgba(230,240,255,.6);
}

*{box-sizing:border-box}
body{
  margin:0;
  font-family:Inter,system-ui;
  background:radial-gradient(circle at 20% 0%, #0f1f3d, #060c18);
  color:var(--text);
  display:flex;
}

/* SIDEBAR */
.sidebar{
  width:240px;
  background:linear-gradient(180deg,#0b1426,#0a1222);
  padding:30px 20px;
  border-right:1px solid var(--border);
}

.logo{
  font-size:22px;
  font-weight:900;
  margin-bottom:35px;
}

.nav{
  padding:12px 14px;
  border-radius:10px;
  cursor:pointer;
  margin-bottom:10px;
  color:var(--muted);
  transition:.2s;
}

.nav:hover{
  background:rgba(59,130,246,.15);
  color:white;
}

.nav.active{
  background:rgba(59,130,246,.25);
  color:white;
}

/* CONTENT */
.content{
  flex:1;
  padding:40px;
}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(320px,1fr));
  gap:25px;
  margin-bottom:30px;
}

.card{
  background:linear-gradient(180deg,var(--card),#0d1628);
  border-radius:16px;
  padding:25px;
  border:1px solid var(--border);
}

/* PLAYER CARD */
.player-card{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:18px;
  border-radius:14px;
  background:rgba(255,255,255,.04);
  border:1px solid var(--border);
  margin-bottom:14px;
  transition:.2s;
}

.player-card:hover{
  background:rgba(59,130,246,.08);
  border-color:var(--blueGlow);
}

.player-left{
  display:flex;
  align-items:center;
  gap:16px;
}

.avatar{
  width:50px;
  height:50px;
  border-radius:50%;
  background:linear-gradient(180deg,#2a3d66,#1b2a4d);
}

.player-name{font-weight:800}
.player-meta{font-size:12px;color:var(--muted)}

.badge{
  padding:4px 10px;
  border-radius:8px;
  font-size:11px;
  font-weight:800;
  margin-left:10px;
}

.badge-clean{background:rgba(34,197,94,.2);color:var(--green);}
.badge-warn{background:rgba(245,158,11,.2);color:var(--yellow);}
.badge-danger{background:rgba(239,68,68,.2);color:var(--red);}

.player-actions{
  display:flex;
  gap:8px;
}

button{
  padding:8px 12px;
  border-radius:8px;
  border:1px solid transparent;
  font-weight:700;
  cursor:pointer;
  transition:.2s;
}

.btn-blue{background:rgba(59,130,246,.2);border-color:var(--blue);color:var(--blue);}
.btn-yellow{background:rgba(245,158,11,.2);border-color:var(--yellow);color:var(--yellow);}
.btn-red{background:rgba(239,68,68,.2);border-color:var(--red);color:var(--red);}
.btn-grey{background:transparent;border-color:rgba(255,255,255,.2);color:white;}

button:hover{filter:brightness(1.2)}

.log{
  padding:10px;
  font-size:13px;
  border-bottom:1px solid rgba(255,255,255,.05);
  color:var(--muted);
}

.status-online{color:var(--green);font-weight:800}
.status-offline{color:var(--red);font-weight:800}

</style>
</head>

<body>

<div class="sidebar">
  <div class="logo">ðŸ‘» GhostGuard</div>
  <div class="nav active" onclick="showView('dashboard',this)">Dashboard</div>
  <div class="nav" onclick="showView('players',this)">Players</div>
  <div class="nav" onclick="showView('logs',this)">Server Logs</div>
</div>

<div class="content">

<!-- DASHBOARD -->
<div id="dashboardView">
  <div class="grid">
    <div class="card">
      <h3>License</h3>
      <p>Status: <span id="licenseStatus">Loading...</span></p>
      <p>Expires: <span id="licenseExpire">-</span></p>
    </div>

    <div class="card">
      <h3>Server</h3>
      <p>Status: <span id="serverStatus">Loading...</span></p>
      <p>Players: <span id="playerCountDash">0</span></p>
    </div>
  </div>
</div>

<!-- PLAYERS -->
<div id="playersView" style="display:none;">
  <h2>Aktiva Spelare (<span id="playerCount">0</span>)</h2>
  <div id="playerList"></div>
</div>

<!-- LOGS -->
<div id="logsView" style="display:none;">
  <h2>Live Logs</h2>
  <div id="logList"></div>
</div>

</div>

<script>
const API="https://ghostgaurd-becakd.onrender.com";
const licenseKey=localStorage.getItem("gg_license_key")||"";
const token=localStorage.getItem("gg_token")||"";

function showView(view, el){
  document.querySelectorAll(".nav").forEach(n=>n.classList.remove("active"));
  el.classList.add("active");

  dashboardView.style.display="none";
  playersView.style.display="none";
  logsView.style.display="none";

  document.getElementById(view+"View").style.display="block";
}

function getBadge(w){
  if(w>=2) return `<span class="badge badge-danger">${w} VARNINGAR</span>`;
  if(w==1) return `<span class="badge badge-warn">1 VARNING</span>`;
  return `<span class="badge badge-clean">CLEAN</span>`;
}

async function fetchLicense(){
  const res=await fetch(API+"/customer/dashboard",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token})});
  const data=await res.json();
  if(!data.success) return;
  licenseStatus.innerText=data.data.status;
  licenseExpire.innerText=data.data.expires_at?new Date(data.data.expires_at).toLocaleString():"Lifetime";
}

async function fetchServer(){
  const res=await fetch(API+"/api/server/status/"+licenseKey);
  const data=await res.json();
  serverStatus.innerText=data.online?"Online":"Offline";
  serverStatus.className=data.online?"status-online":"status-offline";
  playerCountDash.innerText=data.players||0;
}

async function fetchPlayers(){
  const res=await fetch(API+"/api/server/players/"+licenseKey);
  const data=await res.json();
  const players=data.players||[];
  playerCount.innerText=players.length;

  playerList.innerHTML=players.map(p=>`
    <div class="player-card">
      <div class="player-left">
        <div class="avatar"></div>
        <div>
          <div>
            <span class="player-name">${p.name}</span>
            ${getBadge(p.warnings||0)}
          </div>
          <div class="player-meta">ID: ${p.id}</div>
        </div>
      </div>

      <div class="player-actions">
        <button class="btn-blue" onclick="screenshot(${p.id})">SCREENSHOT</button>
        <button class="btn-yellow" onclick="kick(${p.id})">KICK</button>
        <button class="btn-red" onclick="ban(${p.id})">BAN</button>
      </div>
    </div>
  `).join("");
}

async function fetchLogs(){
  const res=await fetch(API+"/api/server/logs/"+licenseKey);
  const data=await res.json();
  logList.innerHTML=(data.data||[]).slice(0,50).map(l=>`
    <div class="log">${new Date(l.time).toLocaleTimeString()} - ${l.message}</div>
  `).join("");
}

async function send(type,payload){
  await fetch(API+"/api/dashboard/action",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({token,license_key:licenseKey,type,payload})
  });
}

async function screenshot(id){
  await send("screenshot",{player:id});
  alert("Screenshot requested â†’ Discord");
}

async function kick(id){
  const reason=prompt("Reason:");
  if(!reason) return;
  await send("kick",{player:id,reason});
}

async function ban(id){
  const reason=prompt("Reason:");
  if(!reason) return;
  const duration=prompt("Duration (30m,2h,7d,P):");
  if(!duration) return;
  await send("ban",{player:id,reason,duration});
}

setInterval(fetchServer,5000);
setInterval(fetchPlayers,3000);
setInterval(fetchLogs,4000);

fetchLicense();
fetchServer();
fetchPlayers();
fetchLogs();
</script>

</body>
</html>
