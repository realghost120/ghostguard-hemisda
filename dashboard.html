<!DOCTYPE html>
<html lang="sv">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>GhostGuard Panel</title>

<style>
:root{
  --bg:#060c18;
  --bg2:#0c1426;
  --card:#101a2e;
  --blue:#3b82f6;
  --blueGlow:rgba(59,130,246,.4);
  --red:#ef4444;
  --yellow:#f59e0b;
  --border:rgba(255,255,255,.06);
  --text:#e6f0ff;
  --muted:rgba(230,240,255,.6);
}

*{box-sizing:border-box}
body{
  margin:0;
  font-family:Inter,system-ui;
  background:radial-gradient(circle at 20% 0%, #0f1f3d, #060c18);
  color:var(--text);
  display:flex;
}

/* SIDEBAR */
.sidebar{
  width:240px;
  background:linear-gradient(180deg,#0b1426,#0a1222);
  padding:30px 20px;
  border-right:1px solid var(--border);
}

.logo{
  font-size:22px;
  font-weight:900;
  margin-bottom:35px;
}

.nav{
  padding:12px 14px;
  border-radius:10px;
  cursor:pointer;
  margin-bottom:10px;
  color:var(--muted);
  transition:.2s;
}

.nav:hover{
  background:rgba(59,130,246,.15);
  color:white;
}

.nav.active{
  background:rgba(59,130,246,.25);
  color:white;
}

/* CONTENT */
.content{
  flex:1;
  padding:40px;
}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(320px,1fr));
  gap:25px;
}

.card{
  background:linear-gradient(180deg,var(--card),#0d1628);
  border-radius:16px;
  padding:25px;
  border:1px solid var(--border);
  box-shadow:0 0 40px rgba(0,0,0,.4);
}

.card h3{
  margin:0 0 20px 0;
  font-size:18px;
  font-weight:900;
}

.row{
  display:flex;
  justify-content:space-between;
  padding:8px 0;
  border-bottom:1px solid rgba(255,255,255,.05);
}

.row:last-child{border:none}

.status-online{color:#22c55e;font-weight:800}
.status-offline{color:var(--red);font-weight:800}

/* PLAYERS */
.player{
  padding:14px;
  border-radius:12px;
  background:rgba(59,130,246,.08);
  margin-bottom:10px;
  cursor:pointer;
  transition:.2s;
  border:1px solid transparent;
}

.player:hover{
  background:rgba(59,130,246,.18);
  border-color:var(--blueGlow);
}

/* LOGS */
.log{
  font-size:13px;
  padding:6px 0;
  border-bottom:1px solid rgba(255,255,255,.05);
  color:var(--muted);
}

/* PANEL */
#panel{
  position:fixed;
  right:-380px;
  top:0;
  width:360px;
  height:100%;
  background:linear-gradient(180deg,#0d1628,#0a1222);
  border-left:1px solid var(--border);
  padding:30px;
  transition:.3s;
  box-shadow:-20px 0 50px rgba(0,0,0,.5);
}

#panel.active{right:0}

button{
  width:100%;
  padding:12px;
  border:none;
  border-radius:12px;
  margin-top:12px;
  cursor:pointer;
  font-weight:800;
  transition:.2s;
}



.toggle {
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:12px;
  border-radius:10px;
  margin-bottom:10px;
  background:#111827;
  cursor:pointer;
  transition:.2s;
}

.toggle.active {
  background:rgba(59,130,246,.25);
  box-shadow:0 0 12px var(--blueGlow);
}

.toggle span {
  font-weight:700;
}


  
.btn-yellow{background:var(--yellow);color:#000}
.btn-red{background:var(--red);color:white}
.btn-blue{background:var(--blue);color:white}
.btn-grey{background:#1f2937;color:white}

button:hover{filter:brightness(1.1)}
</style>
</head>

<body>

<div class="sidebar">
  <div class="logo">ðŸ‘» GhostGuard</div>
  <div class="nav active" onclick="showView('dashboard',this)">Dashboard</div>
  <div class="nav" onclick="showView('players',this)">Players</div>
  <div class="nav" onclick="showView('logs',this)">Server Logs</div>
</div>


<div class="content">

<div id="dashboardView">
  <div class="grid">
    <div class="card">
      <h3>License</h3>
      <div class="row"><span>Status</span><span id="licenseStatus">Loading...</span></div>
      <div class="row"><span>Expires</span><span id="licenseExpire">-</span></div>
    </div>

    <div class="card">
      <h3>Server</h3>
      <div class="row"><span>Status</span><span id="serverStatus">Loading...</span></div>
      <div class="row"><span>Players</span><span id="playerCount">0</span></div>
    </div>
  </div>
</div>

<div id="playersView" style="display:none;">
  <div class="card">
    <h3>Online Players</h3>
    <div id="playerList"></div>
  </div>
</div>

<div id="logsView" style="display:none;">
  <div class="card">
    <h3>Live Logs</h3>
    <div id="logList"></div>
  </div>
</div>

  
</div>

<div id="panel">
  <h3 id="panelName">Player</h3>
  <div id="panelId" style="color:var(--muted);margin-bottom:20px;"></div>

  <button class="btn-yellow" onclick="kick()">Kick</button>
  <button class="btn-red" onclick="ban()">Ban</button>
  <button class="btn-blue" onclick="dm()">Send DM</button>
  <button class="btn-grey" onclick="closePanel()">Close</button>
</div>

<script>
const API="https://ghostgaurd-becakd.onrender.com";
const licenseKey=localStorage.getItem("gg_license_key")||"";
const token=localStorage.getItem("gg_token")||"";
let selectedPlayer=null;

function showView(view, el){
  document.querySelectorAll(".nav").forEach(n=>n.classList.remove("active"));
  el.classList.add("active");

  dashboardView.style.display="none";
playersView.style.display="none";
logsView.style.display="none";


  document.getElementById(view+"View").style.display="block";

  



async function fetchLicense(){
  if(!token) return;
  const res=await fetch(API+"/customer/dashboard",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token})});
  const data=await res.json();
  if(!data.success) return;
  licenseStatus.innerText=data.data.status;
  licenseExpire.innerText=data.data.expires_at?new Date(data.data.expires_at).toLocaleString():"Lifetime";
}

async function fetchServer(){
  const res=await fetch(API+"/api/server/status/"+encodeURIComponent(licenseKey));
  const data=await res.json();
  serverStatus.innerText=data.online?"Online":"Offline";
  serverStatus.className=data.online?"status-online":"status-offline";
  playerCount.innerText=data.players||0;
}

async function fetchPlayers(){
  const res=await fetch(API+"/api/server/players/"+encodeURIComponent(licenseKey));
  const data=await res.json();
  const list=data.players||[];
  playerList.innerHTML=list.map(p=>`
    <div class="player" onclick="openPanel(${p.id},'${p.name.replace(/'/g,"")}')">
      <b>${p.name}</b><br>
      <span style="color:var(--muted)">ID: ${p.id}</span>
    </div>
  `).join("");
}

function openPanel(id,name){
  selectedPlayer=id;
  panelName.innerText=name;
  panelId.innerText="Server ID: "+id;
  panel.classList.add("active");
}

function closePanel(){ panel.classList.remove("active"); }

async function send(type,payload){
  const res=await fetch(API+"/api/dashboard/action",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({token,license_key:licenseKey,type,payload})
  });
  const data=await res.json();
  return data.success;
}

async function kick(){
  if(!selectedPlayer) return;
  const reason=prompt("Reason:");
  if(!reason) return;
  const ok=await send("kick",{player:selectedPlayer,reason});
  if(ok) alert("Kick sent");
}

async function ban(){
  if(!selectedPlayer) return;
  const reason=prompt("Reason:");
  if(!reason) return;
  const duration=prompt("Duration (30m,2h,7d,P):");
  if(!duration) return;
  const ok=await send("ban",{player:selectedPlayer,reason,duration});
  if(ok) alert("Ban sent");
}

async function dm(){
  if(!selectedPlayer) return;
  const message=prompt("Message:");
  if(!message) return;
  const ok=await send("dm",{player:selectedPlayer,message});
  if(ok) alert("DM sent");
}

async function fetchLogs(){
  const res=await fetch(API+"/api/server/logs/"+encodeURIComponent(licenseKey));
  const data=await res.json();
  logList.innerHTML=(data.data||[]).slice(0,50).map(l=>`
    <div class="log">${new Date(l.time).toLocaleTimeString()} - ${l.message}</div>
  `).join("");
}


  
setInterval(fetchServer,5000);
setInterval(fetchPlayers,3000);
setInterval(fetchLogs,3000);

fetchLicense();
fetchServer();
fetchPlayers();
fetchLogs();
</script>

</body>
</html>



